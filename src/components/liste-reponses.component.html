<div class="page">
  <!-- HERO -->
  <div class="hero">
    <div class="hero__left">
      <button type="button" class="btn-back" (click)="goBack()">
        <svg class="icon" viewBox="0 0 24 24" aria-hidden="true">
          <path d="M15 18l-6-6 6-6" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
        </svg>
        <span>Retour</span>
      </button>

      <h2>R√©ponses de la r√©clamation #{{ reclamationId }}</h2>
      <p class="hero__sub">Historique des √©changes</p>
    </div>

    <div class="hero__actions">
      <button type="button" class="btn btn--primary" *ngIf="isAgent" (click)="goNew()">
        <svg class="icon" viewBox="0 0 24 24" aria-hidden="true">
          <path d="M12 20h9M16.5 3.5a2.12 2.12 0 1 1 3 3L8 18l-4 1 1-4Z" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
        </svg>
        Nouvelle r√©ponse
      </button>
    </div>
  </div>

  <!-- STATES -->
  <div *ngIf="loading" class="loading">
    <div class="spinner"></div>
    <p>Chargement‚Ä¶</p>
  </div>
  <div *ngIf="!loading && error" class="alert alert--error">{{ error }}</div>
  <div *ngIf="!loading && !error && !groups.length" class="empty">
    <div class="empty__icon">üì≠</div>
    <h3>Aucune r√©ponse pour l‚Äôinstant</h3>
    <button class="btn btn--primary" *ngIf="isAgent" (click)="goNew()">Nouvelle r√©ponse</button>
  </div>

  <!-- TIMELINE -->
  <section *ngIf="!loading && !error && groups.length" class="timeline">
    <div class="day" *ngFor="let g of groups">
      <div class="day__label">{{ g.label }}</div>

      <ul class="msgs">
        <li class="msg"
            *ngFor="let m of g.items"
            [ngClass]="{'msg--agent': m.role==='agent', 'msg--client': m.role==='client', 'msg--mine': m.mine}">
          <div class="avatar"
               [ngClass]="{'avatar--agent': m.role==='agent', 'avatar--client': m.role==='client'}"
               [attr.data-initials]="m.initials"></div>

          <div class="bubble"
               [ngClass]="{'bubble--agent': m.role==='agent', 'bubble--client': m.role==='client', 'bubble--mine': m.mine}">
            <div class="bubble__head">
              <strong class="author"
                      [ngClass]="{'author--agent': m.role==='agent', 'author--client': m.role==='client'}">
                {{ m.author }}
              </strong>
              <span class="time">{{ m.time }}</span>
            </div>
            <div class="bubble__body">{{ m.message }}</div>
          </div>
        </li>
      </ul>
    </div>
  </section>
</div>
